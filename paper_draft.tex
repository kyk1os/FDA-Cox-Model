\documentclass[11pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{authblk}
\usepackage{natbib}
\usepackage{float}
\usepackage{setspace}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{subcaption}

\doublespacing

\title{Functional Cox Regression for Time-to-Event Prediction: Learning Phase-Specific Effects from Longitudinal Trajectories}
\author{}
\date{}

\begin{document}

\maketitle

\begin{abstract}
Time-to-event prediction is central in applications where decisions depend not only on \emph{whether} an event will occur but also on \emph{when}. In modern settings, individuals are often monitored longitudinally, yielding irregular trajectories of performance, biomarkers or sensor readings. Standard survival models typically compress these trajectories into scalar summaries, sacrificing information about \emph{which} phases are most predictive. Black-box methods can exploit rich features but rarely provide phase-specific interpretation.

We apply and empirically evaluate a functional Cox regression framework that treats each trajectory as a functional covariate. The log-hazard includes a linear functional of the trajectory over a normalised phase variable, yielding a coefficient function that reveals how different parts contribute to the hazard. We compare four model classes: scalar Cox proportional hazards, random survival forest, functional linear Cox model (FLCM) and additive functional Cox model (AFCM) with nonlinear effects.

As a case study we analyse annual season-best performances (one observation per athlete--event--year) from $67{,}977$ athlete--event careers of Olympic-level track-and-field athletes, yielding $347{,}625$ yearly observations extracted from over $1.3$ million competitive performances. The goal is to predict time from event debut to peak performance, which has direct implications for talent identification, resource allocation in national sporting programs, and athlete-specific career planning. Across event families, functional models consistently achieve the best discrimination and rank correlation, showing that trajectory shape contains substantial information beyond scalar summaries. After calibration, functional models also attain lower prediction errors in most families, although scalar Cox remains competitive.

The estimated coefficient $\beta(s)$ can be summarised over early, mid and late career phases, highlighting when above-typical performance predicts earlier or later peaks. These phase-specific effects cannot be extracted from scalar models and provide actionable insights for performance forecasting and intervention timing. We argue that functional Cox regression offers a practical and interpretable approach for time-to-event prediction from longitudinal trajectories in domains ranging from sport science to medicine, reliability and behavioural analytics.
\end{abstract}

\vspace{1em}
\noindent\textbf{Keywords:} Functional Data Analysis; Explainable AI; Longitudinal Phenotyping; Sports Analytics; Survival Analysis.

\section{Introduction}

Time-to-event prediction problems arise whenever we wish to forecast \emph{when} a particular outcome will occur. Examples include time-to-disease onset or progression in medicine, time-to-equipment failure in reliability, time-to-user churn in digital platforms, and time-to-educational milestones. In many of these applications an individual's state is monitored repeatedly before the event, generating rich longitudinal trajectories of biomarkers, performance scores, usage patterns or sensor traces.

Classical survival analysis methods typically incorporate such data through a small number of engineered summaries---for example, the current value of a biomarker, a slope estimate or an accumulated exposure. This strategy is simple and often effective, but it obscures the \emph{temporal structure} of the trajectory and makes it impossible to answer questions such as: \emph{which phase of the trajectory is most predictive for the event time?} Black-box machine learning approaches such as random survival forests or deep survival networks can ingest high-dimensional features but usually provide limited insight into phase-specific effects.

Functional data analysis (FDA) offers an alternative perspective in which longitudinal trajectories are treated as smooth functions rather than as collections of summary statistics \citep{RamsaySilverman}. In a functional regression framework one relates scalar or functional responses to functional predictors via coefficient functions that vary over the trajectory domain. When combined with Cox-type survival models, this leads to \emph{functional Cox regression}, where the log-hazard includes a term of the form $\int_0^1 \beta(s) X_i(s) \, ds$ involving an unknown coefficient function $\beta(s)$ and an individual trajectory $X_i(s)$. Regions of the domain where $|\beta(s)|$ is large correspond to phases in which the trajectory carries strong information about the hazard.

This functional Cox framework addresses both limitations noted above: by modelling the full trajectory $X_i(s)$ it retains phase-specific information that scalar summaries discard, while the explicit coefficient function $\beta(s)$ provides interpretable insight into \emph{which} phases drive predictions---something opaque in black-box models. Moreover, with explicit smoothness assumptions and a well-defined functional form, functional Cox models can achieve stable estimates with moderate sample sizes (tens of thousands rather than millions), making them particularly well-suited for settings where interpretability and sample efficiency are valued alongside predictive performance.

In this paper we apply and evaluate a functional Cox regression framework for time-to-event prediction from longitudinal trajectories. Our focus is methodological: we wish to understand when modelling full trajectories as functional covariates yields tangible gains over strong scalar baselines, and what kinds of additional insight functional models can provide. To ground the discussion we use a large-scale case study from sport science: predicting the time from event debut to performance peak in elite track-and-field athletes. Here each individual is observed through an irregular performance trajectory over their career, and the event of interest is the year of peak performance in a given event. This setting provides a challenging, data-rich example of a general problem: predicting an event time from an informative longitudinal trajectory.

Using a database of annual season-best results (extracted from over one million competitive performances), we construct standardized performance trajectories for each athlete--event combination and define time-to-peak as the number of years from first recorded season to the (possibly censored) year of peak performance. We then compare four classes of models within broad event families: (i) a scalar Cox proportional hazards model using career length and observation count as covariates; (ii) a random survival forest using the same scalars; (iii) a functional linear Cox model (FLCM) in which the log-hazard depends linearly on the full performance trajectory; and (iv) an additive functional Cox model (AFCM) allowing nonlinear functional effects.

Our main contributions are as follows:
\begin{enumerate}[label=(\roman*)]
  \item We present a practical pipeline for functional Cox regression with irregular longitudinal trajectories, including time normalization, spline smoothing, within-career standardisation and a simple calibration step that maps model risk scores to absolute event times.
  \item We provide a unified empirical comparison of scalar Cox, random survival forest, FLCM and AFCM models across multiple event families, using harmonised covariates and a common evaluation protocol based on both hazard-based discrimination and calibrated time-to-event prediction.
  \item Across families, the additive functional Cox model (AFCM) achieves the best overall performance in C-index (hazard-based discrimination) compared to the functional linear, scalar Cox, and random forest models. Furthermore, after calibration, the AFCM also yields the lowest Root Mean Squared Error (RMSE) and Mean Absolute Error (MAE) for predicting the time-to-peak, demonstrating that nonlinear functional effects are crucial for accurate absolute time prediction. The functional linear Cox model (FLCM) remains a strong second-best performer and provides a transparent coefficient function for phase-specific interpretability.
  \item Through the case study on peak performance in track-and-field, we illustrate how these phase-specific effects align with substantive notions such as ``early peakers'' and ``late developers'', and discuss how similar insights could be exploited in other application domains.
\end{enumerate}

The rest of the paper is organized as follows. Section~\ref{sec:data} describes the dataset, outcome definition, and construction of functional trajectories. Section~\ref{sec:methods} introduces the scalar and functional survival models, along with the evaluation framework. Section~\ref{sec:results} presents empirical results across event families. Section~\ref{sec:phase_effects} interprets the estimated functional effects and visualizes phase-specific patterns. Section~\ref{sec:discussion} discusses implications and broader applications, and Section~\ref{sec:conclusion} concludes.

\section{Data and Problem Formulation}
\label{sec:data}

\subsection{Dataset and event families}

We analyze a large-scale dataset of track-and-field performances from athletes who competed at Olympic Games between 1996 and 2024. For each Olympic athlete, we obtained their complete competitive career history via the World Athletics public API (worldathletics.org), yielding annual season-best results for male and female athletes across $93$ distinct events. The data span each athlete's full career from debut through early 2025, ensuring comprehensive longitudinal trajectories for world-class careers. After preprocessing, the working dataset contains $N_{\text{AE}} = 67{,}977$ athlete--event combinations and $347{,}625$ yearly observations.\footnote{These counts are obtained after applying all data quality filters and inclusion criteria described in Section~\ref{subsec:outcome}. The exact figures are reproducible by running the accompanying R code (see supplementary materials).}

Events are grouped into broad families reflecting physiological and biomechanical similarities:
\begin{itemize}
  \item \textbf{Sprint}: short track events (e.g., 100m, 200m, 400m).
  \item \textbf{Hurdles}: short and intermediate hurdle events.
  \item \textbf{Middle distance}: track events in the approximate 800--3000m range.
  \item \textbf{Long distance}: longer track events (e.g., 5000m, 10\,000m) and track-based distance races.
  \item \textbf{Road}: road races (e.g., 10km, half-marathon, marathon).
  \item \textbf{Field}: jumps and throws. Although these disciplines differ biomechanically, we group them together as non-cyclical, technique-intensive power events that contrast with the cyclical running disciplines. Empirical analysis confirms that functional models achieve strong discrimination within this combined category, suggesting that the flexible baseline hazard and trajectory-specific functional effects adequately capture heterogeneity between jumping and throwing events.
  \item \textbf{Combined}: multi-event competitions (e.g., decathlon, heptathlon).
\end{itemize}
Within each family, we fit separate models that share the same covariate specification but allow the baseline hazard and regression parameters to differ.

\subsection{Standardized performance metric}

Raw performance measures (times, distances, points) are not directly comparable across events, sexes, or eras. We therefore use the standardized performance score provided by the World Athletics database (\texttt{result\_score}), which maps each competitive result to a dimensionless score on which larger values consistently correspond to better performance. This official scoring system accounts for event-specific scales, historical performance distributions, and ensures comparability across different disciplines and competition eras. The resulting score reflects a performance level relative to the broader field of athletes competing in the same event.

For each athlete--event combination, we extract the standardized annual season-best score (the maximum \texttt{result\_score} achieved in each calendar year) for each year in which the athlete records a result in that event. This yields an irregularly spaced longitudinal series for each athlete--event pair, which we then embed on a common time grid as described below.

\paragraph{Why annual season-bests?}
Although the underlying database contains multiple performances per athlete within a calendar year, we summarize each athlete--event--year by the standardized \emph{annual season-best} and treat $\{Y_{ij}\}_{j=1}^{L_i}$ as the longitudinal series used to construct the functional trajectory $X_i(s)$. This design aligns the longitudinal resolution with our event definition (the \emph{year} of peak performance) and improves comparability across athletes whose within-year competition schedules are highly irregular. Using all within-year results to fit $X_i(s)$ would in principle provide denser trajectories, but it introduces several practical complications: athletes who compete more frequently would contribute disproportionately many observations; the timing and frequency of competitions are likely informative (injury, qualification attempts, travel, selection), creating an observation process that is not missing-at-random; and intra-year seasonality (tapering, championship peaks) would require an additional modelling layer to avoid conflating short-term peaks with long-term progression. We therefore use annual season-bests as a robust, interpretable proxy for the latent year-to-year progression curve, while retaining overall \emph{observation density} through the scalar covariate $\log(n_{\text{obs},i})$ (number of observed seasons) included in all models.


\subsection{Outcome definition and censoring}
\label{subsec:outcome}

Let $i$ index athlete--event combinations. Define $t^{\text{first}}_i$ and $t^{\text{last}}_i$ as the first and last calendar years in which athlete $i$ records a standardized season-best in the given event. We define the \emph{career length} as
\[
  L_i = t^{\text{last}}_i - t^{\text{first}}_i + 1,
\]
and denote by $Y_{ij}$ the standardized season-best score in career year $j \in \{1,\dots,L_i\}$, where $j = 1$ corresponds to calendar year $t^{\text{first}}_i$.

For each athlete--event $i$, we identify the \emph{observed peak} as the year within the observed trajectory at which $Y_{ij}$ attains its maximum. Let $j^{\star}_i$ denote the index of this peak, and define the corresponding \emph{time to observed peak} (in years since event debut) as
\[
  U_i = j^{\star}_i - 1.
\]

If the athlete's last observed year $t^{\text{last}}_i$ occurs in or after 2023, the athlete is considered still active, and the observed peak $U_i$ represents only the \emph{best performance to date}, not necessarily the true lifetime career peak. We therefore treat such careers as right-censored. Specifically, we define the event indicator
\[
\Delta_i =
\begin{cases}
1, & \text{if } t_i^{\text{last}} < 2023 \quad (\text{career ended; peak observed}),\\[4pt]
0, & \text{if } t_i^{\text{last}} \ge 2023 \quad (\text{still active; right-censored}),
\end{cases}
\]
and the observed time-to-event
\[
  T_i = U_i.
\]
For uncensored athletes ($\Delta_i = 1$), $T_i$ represents the true time from debut to career peak. For censored athletes ($\Delta_i = 0$), $T_i$ is the time to the best performance observed so far, but the true peak may occur in the future. Formal inclusion criteria exclude pathological cases where the trajectory does not exhibit a meaningful rise.

Across all event families, approximately 80\% of athlete--event combinations have retired and exhibit an observed peak within the follow-up window ($\Delta_i = 1$), while the remaining 20\% are still active and thus right censored. The median time-to-peak is 3 years from event debut (95\% CI: [3, 3]), with variation across event families.

Figure~\ref{fig:career_exploration} presents exploratory visualizations of the timing of peak performance. Panel (a) summarizes the empirical distribution of career length and time to peak. Most careers are short and both career length and time-to-peak are heavily right-skewed: the majority of athletes reach their observed peak within the first few years in an event, whereas a small subset exhibit very long careers and late peaks. Stratifying by event family reveals systematic differences, with road and long-distance events tending to peak later on average than sprints and hurdles. Panel (b) presents Kaplan--Meier estimates of the survivor function for time-to-peak by event family. The curves reveal pronounced differences in the timing of peak performance: sprinters tend to reach their peak earliest, with a steep initial decline in the probability of peaking after a given time point, whereas road and long-distance athletes maintain a higher probability of peaking later. A global log-rank test strongly rejects equality of the survivor functions ($p < 0.0001$).

\begin{figure}[H]
  \centering
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{images/visualize-careers-1.pdf}
    \caption{Distributions of career length and time to peak performance. Top: histogram of career length (years). Middle: histogram of time to peak. Bottom: boxplots by event family.}
    \label{fig:dist_time_peak}
  \end{subfigure}
  \hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics[width=\linewidth]{images/km-by-family-1.pdf}
    \caption{Kaplan--Meier estimates of the survivor function for time to peak, stratified by event family. Log-rank test $p < 0.0001$.}
    \label{fig:km_family}
  \end{subfigure}
  \caption{Exploratory analysis of career trajectories and time to peak performance. Panel (a) shows distributions of career length and time to peak across all athlete--event combinations and by event family. Panel (b) shows survival curves for time to peak, revealing significant heterogeneity across event families.}
  \label{fig:career_exploration}
\end{figure}


\subsection{Functional performance trajectories}
\label{subsec:func}

The raw annual sequence $\{Y_{ij}\}_{j=1}^{L_i}$ represents a discrete sample of an underlying smooth performance trajectory over the course of the athlete's career in a given event. To enable functional regression, we map each athlete--event trajectory onto a common domain and obtain a smooth curve.

First, we define a normalized \emph{career phase} variable
\[
  s_{ij} = \frac{j-1}{L_i - 1} \in [0,1],
\]
so that $s = 0$ corresponds to the first season and $s = 1$ to the last observed season within the career. This phase normalization is a key modeling assumption: we treat career progression as phase-relative rather than absolute-time-based, enabling comparison of trajectories across athletes with different career lengths. Under this framework, an athlete's second year (out of five) is treated as comparable to another athlete's fourth year (out of ten), since both occur at $s = 0.25$ in their respective careers. We then approximate the underlying performance trajectory $X_i(s)$ by fitting a smooth function through the points $(s_{ij}, Y_{ij})$. In practice we use cubic smoothing splines with a moderate smoothing parameter to balance fidelity and smoothness. The resulting smooth curve $X_i(s)$ is evaluated on a dense, fixed grid $0 = s_1 < s_2 < \cdots < s_G = 1$ (e.g., $G = 50$), producing a vector
\[
  \bm{X}_i = \big( X_i(s_1), \dots, X_i(s_G) \big)^\top.
\]

To illustrate the resulting functional covariates, Figure~\ref{fig:sample_traj} plots smoothed standardized trajectories for a random subset of 30 careers in each event family over normalized career phase $s \in [0,1]$. Within families, trajectories share a common qualitative pattern: an initial period of improvement followed by a plateau around mid-career and, for many athletes, a decline towards the end of the observed career. The overlaid mean curves highlight systematic differences between families; for example, road and long-distance events tend to exhibit more gradual rises and longer plateaus than sprint and hurdle events. These patterns motivate the use of functional covariates to capture trajectory shape beyond simple scalar summaries.

\begin{figure}[H]
  \centering
  \includegraphics[page=1,width=0.75\linewidth]{images/individual-trajectories-1.pdf}
  \caption{Sample standardized performance trajectories by event family. For each family, 30 athlete--event careers are displayed. The red curve represents the smoothed pointwise mean trajectory, obtained via generalized additive model (GAM) smoothing to highlight the population-level trend without overfitting individual noise. Trajectories are smoothed using penalized regression splines to capture the underlying progression signal while filtering out year-to-year noise. Typical patterns involve early improvement, a mid-career plateau, and eventual decline.}
  \label{fig:sample_traj}
\end{figure}

To stabilize functional estimation and increase comparability across athletes, we perform a within-career standardization of the trajectory, centering each $X_i(s)$ to have mean zero over $s \in [0,1]$ and scaling by its standard deviation. This ensures that functional effects primarily capture shape differences rather than absolute scale, while the scalar variables (Section~\ref{subsec:scalar}) retain information about career length and observation density.

\subsection{Scalar covariates}
\label{subsec:scalar}

In addition to the functional trajectory, we include two scalar covariates that summarize basic features of the career in each event:
\begin{itemize}
  \item \textbf{Career length}: $L_i$ as defined above. We work with a standardized version $Z_{1i} = \text{career\_length\_scaled}_i$, obtained by centering and scaling $L_i$ within each event family.
  \item \textbf{Observation count}: $n_{\text{obs},i}$, the number of distinct yearly observations in the athlete--event trajectory. Since $n_{\text{obs},i}$ is highly correlated with $L_i$, we use a log transformation $Z_{2i} = \log(n_{\text{obs},i})$.
\end{itemize}
These scalars capture the overall duration and data density of each athlete's career in a given event. They are included in all models (scalar and functional) to ensure a fair comparison and to isolate the incremental value of the functional trajectories.

\section{Modelling Framework}
\label{sec:methods}

For each event family, we fit four classes of time-to-event models conditional on the scalar covariates $Z_i$ and, when applicable, the functional trajectory $X_i(\cdot)$. We assume non-informative right-censoring throughout.

We assessed the proportional hazards (PH) assumption using scaled Schoenfeld residuals. A pooled Cox model including event-family indicators showed clear evidence of non-proportionality for the family effects and career-length covariate. Consequently, all Cox and functional Cox models are fitted conditional on the scalar covariates $Z_i$ and, when applicable, the functional trajectory $X_i(\cdot)$. All parameters are estimated \emph{separately within each family}; specifically, we estimate a family-specific functional coefficient $\beta_g(s)$ (for FLCM) or surface $f_g(s,x)$ (for AFCM). In the notation below we suppress the family index $g$ for simplicity, but it is implied that distinct models are fitted for Sprint, Hurdles, Middle distance, Long distance, Road, Field, and Combined. Comparison of the PH assumption for distinct families did not reveal any major systematic departures over the time range considered.

\subsection{Scalar Cox proportional hazards model}

The primary scalar baseline model is a Cox proportional hazards model \citep{Cox1972} with hazard
\begin{equation}
  \lambda_i(t \mid Z_i)
  =
  \lambda_0(t) \exp\big\{ \bm{\gamma}^\top Z_i \big\},
  \label{eq:cox}
\end{equation}
where $\lambda_0(t)$ is an unspecified baseline hazard function common to all athletes in an event family, and $\bm{\gamma} = (\gamma_1, \gamma_2)^\top$ is a vector of log-hazard ratios. Within each family, we fit~\eqref{eq:cox} using the standard partial likelihood approach.

This model captures how the timing of peak performance depends on simple scalar summaries of the career. For example, a negative $\gamma_1$ would indicate that athletes with longer careers (relative to their family peers) tend to reach their peak later.

\subsection{Random survival forest}

As a nonlinear, tree-based benchmark, we fit a random survival forest \citep{Ishwaran2007rsf} (RSF) using the same scalar covariates $Z_i$. An RSF is an ensemble of survival trees, each grown on a bootstrap sample of the data with random subsampling of covariates at each split. Each terminal node corresponds to a subgroup of athletes with similar covariates, and the node-specific survival function is estimated via the Nelson--Aalen or Kaplan--Meier estimator based on the observed event times and censoring indicators.

For each athlete $i$, the RSF produces an estimated cumulative hazard function $\widehat{\Lambda}^{\text{RSF}}_i(t)$, obtained by averaging node-specific hazard estimates across trees. We summarize this function through a scalar \emph{risk score} by evaluating the cumulative hazard at a fixed time point (we use the 75th percentile of observed event times): $r^{\text{RSF}}_i = \widehat{\Lambda}^{\text{RSF}}_i(t_{0.75})$. The RSF thus serves as a flexible, model-free comparator on the same scalar covariate set.

\subsection{Functional linear Cox model (FLCM)}

To incorporate the full shape of the performance trajectory, we extend the Cox model by adding a functional linear term \citep{Kong2018FLCRM}. The hazard for athlete $i$ is specified as
\begin{equation}
  \lambda_i(t \mid Z_i, X_i)
  =
  \lambda_0(t) \exp\left\{
    \bm{\gamma}^\top Z_i
    +
    \int_0^1 \beta(s) X_i(s) \, ds
  \right\},
  \label{eq:flcm}
\end{equation}
where $\beta(s)$ is an unknown coefficient function defined on the normalized career phase $s \in [0,1]$. The integral $\int_0^1 \beta(s) X_i(s) ds$ summarizes how the shape of $X_i(\cdot)$ over the career influences the log-hazard.

In practice, we approximate $X_i(s)$ and $\beta(s)$ using a common basis expansion. Let $\{\phi_k(s)\}_{k=1}^K$ denote a set of spline basis functions (e.g., cubic B-splines), and write
\[
  X_i(s) \approx \sum_{k=1}^K x_{ik} \, \phi_k(s),
  \qquad
  \beta(s) \approx \sum_{k=1}^K b_k \, \phi_k(s).
\]
Then the functional term can be written as
\[
  \int_0^1 \beta(s) X_i(s) \, ds
  \approx
  \sum_{k=1}^K \sum_{\ell=1}^K b_k x_{i\ell}
  \int_0^1 \phi_k(s) \phi_\ell(s) \, ds
  =
  \bm{b}^\top \bm{M} \bm{x}_i,
\]
where $\bm{M}$ is the $K \times K$ matrix with entries $M_{k\ell} = \int_0^1 \phi_k(s)\phi_\ell(s) ds$ and $\bm{x}_i$ collects the basis coefficients of $X_i$. Equivalently, we may work with a reduced set of functional principal component scores extracted from $\bm{X}_i$, and treat those scores as additional linear covariates.

The functional coefficient vector $\bm{b}$ and scalar coefficients $\bm{\gamma}$ are estimated by maximizing a penalized partial likelihood with roughness penalties (e.g., $\int_0^1\{\beta''(s)\}^2ds$) to obtain a smooth $\widehat{\beta}(s)$. The smoothing parameter is selected via REML/GCV as implemented in the \texttt{mgcv} package \citep{Wood2011mgcv}, and can be visualized to interpret which phases of the career are most predictive of earlier or later peak times.

\subsection{Additive functional Cox model (AFCM)}

The linear functional term in~\eqref{eq:flcm} may be overly restrictive if the effect of performance at a given career phase is nonlinear in $X_i(s)$. We therefore also consider an additive functional Cox model:
\begin{equation}
  \lambda_i(t \mid Z_i, X_i)
  =
  \lambda_0(t) \exp\left\{
    \bm{\gamma}^\top Z_i
    +
    \int_0^1 f\big(s, X_i(s)\big) \, ds
  \right\},
  \label{eq:afcm}
\end{equation}
where $f(s, x)$ is an unknown smooth bivariate function. In this specification, the contribution to the log-hazard at phase $s$ depends flexibly on both $s$ and the local performance level $x$. A natural implementation uses tensor-product splines:
\[
  f(s, x)
  \approx
  \sum_{k=1}^{K_s} \sum_{\ell=1}^{K_x} \theta_{k\ell} \, \psi_k(s)\,\phi_\ell(x),
\]
with appropriate smoothing penalties over the tensor-product surface. Estimation proceeds via penalized partial likelihood, analogous to generalized additive models with a Cox likelihood.

The fitted surface $\widehat{f}(s,x)$ can be visualized as a heatmap over $(s,x)$, providing richer insight into how performance early, mid-career, or late in the observed trajectory influences peak timing.

\subsection{Retrospective prediction and cross-validation}

We emphasize that this analysis is \textit{retrospective}: we utilize the full observed trajectory $X_i(s)$ (normalized to $[0,1]$) to characterize the relationship between career shape and peak timing. This defines a longitudinal phenotyping task rather than online forecasting.

We split the data within each event family into a training set and an independent hold-out test set, stratified at the athlete level to avoid leakage between splits. On the training set we perform 5-fold cross-validation to tune any hyperparameters (e.g., basis dimension and smoothing penalties for functional models; number of trees and node size for the RSF). Within each fold, we fit all four models (Cox, RSF, FLCM, AFCM) using the same training indices and compute risk scores on the held-out fold.

Cross-validation serves two purposes. First, it provides an internal estimate of model discrimination via concordance indices (Section~\ref{subsec:hazard_eval}). Second, it allows us to select hyperparameters that balance model flexibility with overfitting in a systematic way. Once tuning is complete, we refit each model on the full training set with chosen hyperparameters and evaluate predictive performance on the hold-out test set.

\subsection{Evaluation metrics}
\label{subsec:eval}

We evaluate models along two complementary dimensions: (i) their ability to correctly \emph{rank} athletes by the timing of their peak; and (ii) their ability to produce well-calibrated \emph{absolute} time-to-peak predictions.

\subsubsection{Hazard-based evaluation}
\label{subsec:hazard_eval}

Each fitted model produces a risk score $r_i$ for each athlete--event $i$ in the test set. A higher risk score indicates that the model predicts the athlete will reach their peak sooner rather than later. For the scalar Cox model, $r_i = \widehat{\bm{\gamma}}^\top Z_i$. For the FLCM, we set
\[
  r_i = \widehat{\bm{\gamma}}^\top Z_i + \int_0^1 \widehat{\beta}(s)X_i(s) ds.
\]
For the AFCM, we use the linear predictor $r_i = \widehat{\bm{\gamma}}^\top Z_i + \int_0^1 \widehat{f}(s, X_i(s)) ds$, where $\widehat{f}(s,x)$ is the fitted bivariate function. For the RSF, we use $r_i = \widehat{\Lambda}^{\text{RSF}}_i(t_{0.75})$ as described in Section~3.2.

We assess how well models rank athletes by their peak timing using Harrell's concordance index \citep{Harrell1982CIndex} $C$. This measures the probability that, for any two athletes, the model correctly identifies which athlete peaked earlier. For athletes still competing (censored observations), we only compare pairs where the timing relationship is unambiguous: specifically, a pair is comparable if either both athletes have retired and reached their observed peak, or if one is still active but the other reached their peak before the first athlete's last observed competition. We also compute Spearman's rank correlation between the risk scores $\{r_i\}$ and observed times-to-peak $\{T_i\}$ among retired athletes as an additional ranking-based summary.

\subsubsection{Time-to-peak prediction and calibration}

While hazard-based metrics capture how well models rank athletes in terms of peak timing, practical applications often require explicit predictions of the time-to-peak for each athlete. In principle, survival models provide an estimate of the individual survival function $S_i(t)$ from which one can extract, for example, the median time-to-peak $\tilde{T}_i$. However, in our empirical analysis we find that functional Cox models, in particular, can produce survival curves that are substantially miscalibrated in absolute time, despite good ranking performance.

To address this, we adopt a two-step calibration approach. For each event family and each model, we fit a flexible generalized additive model (GAM) that maps the model's risk score $r_i$ to the observed time-to-peak $T_i$ among uncensored athletes in the training set:
\[
  T_i = g(r_i) + \varepsilon_i,
\]
where $g(\cdot)$ is a smooth function estimated via penalized splines and $\varepsilon_i$ is an error term. The fitted function $\widehat{g}$ provides a calibrated mapping from risk scores to predicted event times. On the test set, we obtain predicted times $\widehat{T}_i = \widehat{g}(r_i^{\text{test}})$, where $r_i^{\text{test}}$ is the risk score computed on test-set covariates. This approach recalibrates the scale of predictions while preserving the relative ranking captured by the original risk scores.

We quantify calibration-adjusted prediction accuracy using the root mean squared error (RMSE)
\[
  \text{RMSE} = \sqrt{ \frac{1}{N_{\text{unc}}} \sum_{i:\,\Delta_i = 1} (T_i - \widehat{T}_i)^2 },
\]
and the mean absolute error (MAE)
\[
  \text{MAE} = \frac{1}{N_{\text{unc}}} \sum_{i:\,\Delta_i = 1} |T_i - \widehat{T}_i|,
\]
where $N_{\text{unc}}$ is the number of uncensored athletes in the test set, and $\Delta_i$ is the event indicator defined in Section~\ref{subsec:outcome}.

\section{Model evaluation}
\label{sec:results}

We evaluate models along two complementary dimensions: (i) their ability to correctly \emph{rank} athletes by the timing of their peak; and (ii) their ability to produce wellâ€“calibrated absolute time-to-peak predictions on a held-out test set. All reported metrics are computed separately within each event family using the 20\% test split; numerical values underlying the plots are provided in the Supplementary Material.

\subsection{Hazard-based discrimination}
\label{subsec:eval-hazard}

Each fitted model yields a scalar risk score $r_i$ for each athlete--event $i$ in the test set, where larger values indicate an increased hazard of reaching the peak earlier. For the scalar Cox model we use $r_i = \widehat\gamma^\top Z_i$, while for the FLCM we set
\[
  r_i = \widehat\gamma^\top Z_i + \int_0^1 \widehat\beta(s)\, X_i(s)\, ds,
\]
with analogous linear predictors extracted from the AFCM and RSF. We then assess discrimination using Harrell's concordance index ($C$-index) and the Spearman rank correlation between $\{r_i\}$ and the observed times-to-peak $\{T_i\}$ among uncensored athletes.

Figure~\ref{fig:perf-overview} (top panels) summarizes the hazard-based metrics. In every family the FLCM and AFCM attain the highest C-indices and rank correlations, consistently outperforming the scalar Cox and RSF models. This confirms that the functional trajectory adds significant discriminative power beyond scalar covariates.

These results show that incorporating the full performance trajectories as functional covariates leads to a clear improvement in ranking ability, beyond what can be achieved with scalar summaries of career length and observation density alone. At the same time, all models capture non-trivial structure.

\subsection{Time-to-peak prediction and calibration}
\label{subsec:eval-time}

While hazard-based metrics focus on relative ordering, practical applications often require explicit predictions of the time-to-peak for individual athletes. As described in Section~\ref{subsec:eval}, we obtain calibrated time-to-peak predictions $\widehat T_i$ by fitting, within each event family and model, a smooth mapping from the training-set risk scores $r_i$ to the observed times-to-peak $T_i$ among uncensored athletes, and then applying this mapping to the test-set risk scores. Prediction accuracy is quantified using the root mean squared error (RMSE) and mean absolute error (MAE) among uncensored test-set athletes.

The bottom panels of Figure~\ref{fig:perf-overview} and Table~\ref{tab:calibrated_summary} report the calibrated RMSE and MAE. After calibration, the AFCM achieves the lowest errors on average, indicating that nonlinear, phase-varying functional effects improve not only ranking performance but also absolute time prediction. The FLCM follows closely. The scalar Cox model and RSF generally exhibit higher prediction errors, confirming that the full longitudinal signal adds value for precise timing prediction.

The absolute magnitude of prediction errors---ranging from approximately 1.7 to 2.2 years in MAE and 2.3 to 2.8 years in RMSE across event families---reflects the substantial inherent variability in athletic career trajectories. Peak timing is influenced by a complex interplay of factors not captured in our data, including training regimes, injury history, competition schedules, and individual life circumstances. Nevertheless, all four model classes substantially outperform a naive baseline that always predicts the sample mean time-to-peak (baseline RMSE: 3.46~years): the AFCM achieves 31.9\% error reduction, FLCM 29.8\%, scalar Cox 24.5\%, and RSF 15.1\%. Within this context, the models' ability to consistently improve upon naive predictors and to achieve strong discrimination metrics demonstrates that performance trajectories carry meaningful signal about peak timing, even if point predictions remain uncertain. For practical applications such as talent identification and resource allocation, the relative ranking of athletes (captured by the C-index) may be more valuable than precise year-level forecasts.

Figure~\ref{fig:pred-vs-obs} provides a complementary view of calibration by plotting predicted versus observed time-to-peak for uncensored athletes, faceted by event family and model. After calibration, the scatterplots align reasonably well with the diagonal reference line, but residual patterns differ systematically between models. The functional models produce tight clouds around the diagonal, particularly in sprint, hurdles and middle-distance events, reflecting their ability to exploit both scalar covariates and trajectory shape. Scalar Cox and RSF predictions show more regression to the mean and larger dispersion in late-peaking athletes, consistent with their higher RMSE and MAE.

\subsection{Summary of comparative performance}
\label{subsec:eval-summary}

Taken together, the evaluation results reveal a coherent picture. Functional Cox models (FLCM and AFCM) dominate in hazard-based discrimination and also exhibit the best calibrated time-to-event predictions in most event families. This indicates that the shape of an athlete's performance trajectory carries substantial information about both \emph{relative} and \emph{absolute} peak timing beyond what is captured by overall duration or observation density alone. At the same time, the scalar Cox model remains a strong baseline: with only two covariates and a simple calibration step it achieves performance close to that of the functional models, especially in families where trajectories are more homogeneous.

In practice, this suggests a trade-off. Scalar models may suffice when only coarse-grained predictions of peak timing are required or when computational simplicity is paramount. Functional models become attractive when ranking quality matters, when calibrated predictions are important, or when phase-specific interpretation of the trajectory is a scientific objective. We return to these points in Section~\ref{sec:discussion}.

\begin{table}[H]
    \centering
    \caption{Average calibrated prediction error (RMSE and MAE) for each model class, averaged across all event families. The improvement percentage shows the reduction in RMSE relative to a naive baseline that always predicts the sample mean time-to-peak (3.46~years). All four model classes substantially outperform the baseline, with the AFCM achieving the largest error reduction (31.9\%).}
    \label{tab:calibrated_summary}
    \vspace{0.5em}
    \begin{tabular}{lccc}
        \toprule
        \textbf{Model} & \textbf{RMSE (years)} & \textbf{MAE (years)} & \textbf{Improvement (\%)} \\
        \midrule
        Baseline (Mean) & 3.464 & 2.539 & --- \\
        Scalar Cox      & 2.616 & 1.915 & 24.5 \\
        Random Forest   & 2.940 & 2.154 & 15.1 \\
        FLCM            & 2.432 & 1.782 & 29.8 \\
        AFCM            & 2.360 & 1.729 & 31.9 \\
        \bottomrule
    \end{tabular}
\end{table}

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{images/test-performance-viz-1.pdf}%
  \caption{Comprehensive model evaluation across event families. The four panels display: (Top-Left) C-index for hazard-based discrimination; (Top-Right) Spearman rank correlation between risk scores and observed time-to-peak; (Bottom-Left) Root Mean Squared Error (RMSE) of calibrated time-to-event predictions; and (Bottom-Right) Mean Absolute Error (MAE) of calibrated predictions. Functional models (AFCM, FLCM) consistently outperform scalar baselines in ranking metrics and achieve the lowest prediction errors.}
  \label{fig:perf-overview}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=\textwidth]{images/predicted-vs-actual-scatter-1.pdf}%
  \caption{Predicted versus observed time-to-peak for uncensored athletes in the test set, stratified by event family (columns) and model (rows). The red dashed line indicates perfect calibration ($\widehat T_i = T_i$), and the blue line shows a fitted linear trend. Functional models provide good relative ordering and well-calibrated predictions, with tighter scatter around the diagonal than scalar Cox and RSF in most families.}
  \label{fig:pred-vs-obs}
\end{figure}

\section{Phase-specific functional effects}
\label{sec:phase_effects}

For brevity, we show the coefficient function for the Combined family; coefficient functions for the remaining families are provided in Appendix. To summarize the phase-specific contributions of the functional covariate, we discretize career phase into three equal intervals: Early ($s \in [0, 1/3)$), Mid ($s \in [1/3, 2/3)$), and Late ($s \in [2/3, 1]$). This tripartite division provides an interpretable summary of how the predictive importance of performance varies from career beginning to end. We visualize the estimated coefficient function $\hat\beta(s)$ in Figure~\ref{fig:phase-summary}, while Figure~\ref{fig:phase-heatmap} provides a compact summary of the mean absolute effects by phase.

\begin{figure}[htbp]
    \centering
    \includegraphics[page=1,width=0.95\linewidth]{images/flcm-coefficients-1.pdf}
    \caption{Estimated coefficient function $\hat\beta(s)$ (with 95\% CI) from the FLCM for the combined family. Positive values imply that higher performance at that career phase is associated with earlier peaks (higher hazard), while negative values imply later peaks.}
    \label{fig:phase-summary}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\linewidth]{images/flcm-phase-heatmap-1.pdf}
    \caption{Phase-specific impact of functional performance on time-to-peak. Rows correspond to event families, columns to career phases (early, mid, late). Colour encodes the strength of the functional effect via $|\hat\beta(s)|$, with brighter tiles indicating phases where the trajectory is most informative. The sign indicates the direction of the effect: $+$ means that higher standardized performance during that phase is associated with an earlier peak (higher hazard), while $-$ means that higher performance is associated with a later peak (lower hazard).}
    \label{fig:phase-heatmap}
\end{figure}

\subsection{Phase-specific functional insights}

Bright tiles in Figure~\ref{fig:phase-heatmap} (large $|\hat\beta|$) identify career phases in which the within-career performance trajectory carries strong signal about when an athlete will peak.  These are precisely the regions where functional models extract information that scalar summaries cannot capture.

The sign encodes the direction of the effect.  Positive signs ($+$) indicate phases where $\hat\beta(s) > 0$: athletes who perform above their own typical level in these phases tend to reach their peak earlier, corresponding to an increased hazard of peaking.  Negative signs ($-$) indicate phases where $\hat\beta(s) < 0$: here, above-typical performance is associated with delayed peaks and a reduced hazard. Across most event families, early-career performance has a positive association with earlier peaks, whereas late-career performance tends to have a protective (negative) effect, consistent with the idea that sustained high performance later in a career is characteristic of athletes whose peak occurs later.

\subsection{Scientific value of functional modelling}

A purely scalar Cox model based on career length and log number of observations cannot distinguish \emph{which} parts of the trajectory matter for peak timing: it can only summarise the overall level or duration of performance.  The FLCM, by contrast, decomposes the predictive contribution of the trajectory over career phase and reveals phase-specific dynamics that are invisible to scalar models.  Even in settings where overall predictive performance metrics (e.g.\ $C$-index, RMSE) for functional and scalar models are similar, the functional model delivers interpretable, phase-resolved information about \emph{when} in an individual's trajectory performance is most predictive of event time. This phase-specific insight is the main scientific gain from functional modelling in our application and is directly transferable to other domains where understanding \emph{when} along a longitudinal process risk accumulates or dissipates is of interest.

\section{Discussion}
\label{sec:discussion}

We have examined functional Cox regression as a tool for time-to-event prediction from longitudinal trajectories, using elite track-and-field performance as a case study. The results highlight both the potential and the practical considerations of functional survival models.

Incorporating full performance trajectories as functional covariates yields consistent gains over strong scalar baselines. Functional Cox models achieve the best discrimination and, after calibration, the lowest time-to-peak prediction errors in most event families. This indicates that the \emph{shape} of a trajectory contains genuine predictive information about event timing beyond what can be captured by overall duration or observation density alone. The phase-specific coefficient functions reveal interpretable patterns: early-career performance typically predicts earlier peaks, while sustained high performance later in a career is associated with delayed peaks. These insights are invisible to scalar models and represent the main scientific value of the functional approach.

Our analysis has several limitations. First, we focus exclusively on season-best performances, discarding within-season variation that may contain additional signal. Second, the data lack contextual information such as training load, injury history, or coaching changes that undoubtedly influence peak timing. Third, our censoring mechanism treats all post-2023 careers as censored, which may underestimate peak timing for very recent entrants. Future work could explore joint models that incorporate time-varying covariates, extend the framework to recurrent events (e.g.\ multiple peaks), or investigate whether similar phase-specific effects emerge in domains such as clinical biomarker trajectories or equipment degradation curves.

While our case study focuses on athletic performance, the methodological framework generalizes naturally to other settings with irregular longitudinal monitoring and time-to-event outcomes. In medicine, one might model the trajectory of a biomarker (e.g.\ glucose, blood pressure) to predict time to disease onset, revealing which phases of the patient's monitoring history are most informative. In reliability engineering, sensor readings over equipment lifetime could predict time to failure, identifying critical degradation phases. In digital platforms, user engagement trajectories could predict time to churn. In each domain, the functional Cox framework offers both improved prediction and interpretable, phase-resolved insights into \emph{when} along the trajectory risk accumulates.

\section{Conclusion}
\label{sec:conclusion}

This paper demonstrated that functional Cox regression provides a powerful and interpretable approach for time-to-event prediction from irregular longitudinal trajectories. By treating each trajectory as a functional covariate, we achieve superior discrimination and calibrated predictions compared to scalar Cox and random forest baselines, while simultaneously uncovering phase-specific effects that reveal \emph{which} parts of the trajectory are most predictive of event timing.

In our track-and-field case study, these functional effects align with substantive notions of ``early peakers'' versus ``late developers'', and the estimated coefficient functions provide actionable insights for talent identification and career planning. More broadly, the framework is directly applicable to any domain where understanding the temporal structure of longitudinal risk is scientifically or practically valuable.

We release our full R code and aggregated data to facilitate reproducibility and extensions. Functional survival analysis stands as a natural bridge between complex longitudinal data and interpretable time-to-event modelling, with broad applicability across sport science, medicine, reliability engineering, and behavioural analytics.

\appendix
\section{Appendix: Additional Coefficient Functions}
\label{app:coefficients}

Figure~\ref{fig:app_coefficients} displays the estimated coefficient functions for the remaining event families.

\begin{figure}[H]
    \centering
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/flcm-coefficients-2.pdf}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/flcm-coefficients-3.pdf}
    \end{subfigure}

    \vspace{0.5em}

    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/flcm-coefficients-4.pdf}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/flcm-coefficients-5.pdf}
    \end{subfigure}

    \vspace{0.5em}

    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/flcm-coefficients-6.pdf}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.48\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/flcm-coefficients-7.pdf}
    \end{subfigure}
    \caption{Estimated FLCM coefficient functions for the remaining event families.}
    \label{fig:app_coefficients}
\end{figure}

\bibliographystyle{plainnat}
\nocite{*}
\bibliography{references}

\begin{filecontents*}{references.bib}
@manual{RCoreTeam,
  title = {R: A Language and Environment for Statistical Computing},
  author = {{R Core Team}},
  organization = {R Foundation for Statistical Computing},
  address = {Vienna, Austria},
  year = {2024},
  url = {https://www.R-project.org/}
}

@article{Wood2011mgcv,
  title = {Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models},
  author = {Wood, Simon N.},
  journal = {Journal of the Royal Statistical Society (Series B)},
  volume = {73},
  number = {1},
  pages = {3--36},
  year = {2011}
}

@article{Ishwaran2007rsf,
  title = {Random survival forests},
  author = {Ishwaran, Hemant and Kogalur, Udaya B. and Blackstone, Eugene H. and Lauer, Michael S.},
  journal = {The Annals of Applied Statistics},
  volume = {2},
  number = {3},
  pages = {841--860},
  year = {2008}
}

@book{RamsaySilverman,
  title = {Functional Data Analysis},
  author = {Ramsay, James O. and Silverman, Bernard W.},
  year = {2005},
  publisher = {Springer}
}

@article{Cox1972,
  title = {Regression models and life-tables},
  author = {Cox, David R.},
  journal = {Journal of the Royal Statistical Society (Series B)},
  volume = {34},
  number = {2},
  pages = {187--220},
  year = {1972}
}

@article{Harrell1982CIndex,
  title = {Evaluating the yield of medical tests},
  author = {Harrell, Frank E. and Califf, Robert M. and Pryor, David B. and Lee, Kerry L. and Rosati, Robert A.},
  journal = {JAMA},
  volume = {247},
  number = {18},
  pages = {2543--2546},
  year = {1982}
}

@article{Scheipl2015FAMM,
  title = {Functional additive mixed models},
  author = {Scheipl, Fabian and Staicu, Ana-Maria and Greven, Sonja},
  journal = {Journal of Computational and Graphical Statistics},
  volume = {24},
  number = {2},
  pages = {477--501},
  year = {2015}
}

@article{Ivanescu2015PFFR,
  title = {Penalized function-on-function regression},
  author = {Ivanescu, Andrada E. and Staicu, Ana-Maria and Scheipl, Fabian and Greven, Sonja},
  journal = {Computational Statistics},
  volume = {30},
  pages = {539--568},
  year = {2015}
}

@article{Kong2018FLCRM,
  title = {Functional linear Cox regression model},
  author = {Kong, D. and Ibrahim, J. G. and Lee, E. and Zhu, H.},
  journal = {Biometrics},
  volume = {74},
  number = {1},
  pages = {109--117},
  year = {2018}
}

@article{Uno2011CIndex,
  title = {On the C-statistics for evaluating overall adequacy of risk prediction procedures with censored survival data},
  author = {Uno, Hajime and Cai, Tianxi and Pencina, Michael J. and D'Agostino, Ralph B. and Wei, L. J.},
  journal = {Statistics in Medicine},
  volume = {30},
  number = {10},
  pages = {1105--1117},
  year = {2011}
}
\end{filecontents*}

\end{document}
